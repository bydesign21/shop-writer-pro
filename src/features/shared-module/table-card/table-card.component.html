<nz-card class="table-card" [nzTitle]="cardTitle">
  <div class="table-responsive">
    <nz-spin
      class="table-spinner"
      [nzSpinning]="isLoading$ | async"
      [nzIndicator]="loadingIndicatorRef"
    >
      <nz-table
        class="table-card__table"
        [nzLoading]="isLoading$ | async"
        [nzLoadingIndicator]="loadingIndicatorRef"
        [nzPageIndex]="pageIndex"
        [nzTotal]="(data$ | async)?.length"
        [nzNoResult]="noResultRef"
        (nzPageIndexChange)="handlePageChange($event)"
        [nzPageSize]="pageLimit"
        [nzData]="data$ | async"
      >
        <thead>
          <tr>
            <th>Date</th>
            <th>Status</th>
            <th>VIN</th>
            <th>Model</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of pagedData">
            <td>{{ item.date | date : "MMM, dd. yyyy." }}</td>
            <td>
              <nz-tag
                style="border-radius: 0.8rem"
                [nzColor]="getTicketStatusPillColor(item.status)
                "
                >{{ item.status }}</nz-tag
              >
            </td>
            <td>{{ item.vin }}</td>
            <td>{{ item.model }}</td>
            <td>
              <a (click)="viewTableRow(item)">View</a>
            </td>
          </tr>
        </tbody>
      </nz-table>
    </nz-spin>
  </div>
</nz-card>

<ng-template #viewTicketModal>
  <swp-ticket-viewer (ticketUpdated)="handleUpdateTicket($event)" [rules]="rules" [ticket]="selectedItem"></swp-ticket-viewer>
</ng-template>
